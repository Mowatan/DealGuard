<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Milestone Agreed - DealGuard</title>
  <style>
    body{margin:0;padding:0;font-family:Arial,sans-serif;font-size:16px;line-height:1.5;color:#1f2937;background:#f3f4f6}
    .wrap{width:100%;background:#f3f4f6;padding:20px}
    .container{max-width:600px;margin:0 auto;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
    .header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:30px;text-align:center}
    .header h1{margin:0;font-size:28px;font-weight:700;color:#fff}
    .header p{margin:4px 0 0;font-size:13px;color:#e0e7ff}
    .content{padding:30px}
    .greeting{margin:0 0 20px;font-size:17px;color:#374151;font-weight:500}
    .badge{background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:#fff;padding:12px 20px;border-radius:8px;text-align:center;margin:0 0 24px}
    .badge .icon{font-size:24px;margin-bottom:6px}
    .badge h2{margin:0;font-size:19px;font-weight:600}
    .badge p{margin:4px 0 0;font-size:13px;opacity:0.9}
    .msg{margin:0 0 20px;color:#4b5563;font-size:15px}
    .msg strong{color:#1f2937;font-weight:600}
    .celebration{background:linear-gradient(135deg,#ecfdf5 0%,#d1fae5 100%);border:2px solid #10b981;border-radius:8px;padding:24px;margin:24px 0;text-align:center}
    .celebration .emoji{font-size:48px;margin-bottom:12px}
    .celebration h3{margin:0 0 8px;font-size:18px;font-weight:700;color:#065f46}
    .celebration p{margin:0;font-size:14px;color:#047857}
    .details{background:#f9fafb;border:2px solid #e5e7eb;border-radius:8px;padding:20px;margin:24px 0}
    .details h3{margin:0 0 16px;font-size:14px;font-weight:600;color:#6b7280;text-transform:uppercase}
    .row{display:flex;padding:10px 0;border-bottom:1px solid #e5e7eb}
    .row:last-child{border-bottom:none}
    .label{flex:0 0 40%;font-weight:600;color:#374151;font-size:14px}
    .value{flex:1;color:#6b7280;font-size:14px}
    .value strong{color:#1f2937;font-weight:700}
    .checkmark{display:inline-block;background:#10b981;color:#fff;padding:4px 8px;border-radius:8px;font-size:12px;font-weight:600}
    .progress-box{background:#fffbeb;border:2px solid #f59e0b;border-radius:8px;padding:20px;margin:24px 0}
    .progress-box h3{margin:0 0 12px;font-size:14px;font-weight:600;color:#92400e;text-transform:uppercase}
    .progress-box p{margin:0;font-size:14px;color:#78350f}
    .progress-box .count{font-size:24px;font-weight:700;color:#92400e;margin:8px 0}
    .cta{text-align:center;margin:30px 0}
    .btn{display:inline-block;background:linear-gradient(135deg,#10b981 0%,#059669 100%);color:#fff;text-decoration:none;padding:16px 40px;border-radius:8px;font-weight:700;font-size:16px;box-shadow:0 4px 12px rgba(16,185,129,0.4)}
    .footer{background:#f9fafb;padding:24px;text-align:center;border-top:1px solid #e5e7eb}
    .footer p{margin:0 0 6px;font-size:12px;color:#6b7280}
    .footer .name{font-weight:600;color:#374151}
    .footer .legal{font-size:10px;color:#9ca3af;margin-top:12px}
    .footer a{color:#667eea;text-decoration:none}
    @media(max-width:600px){
      .wrap{padding:10px}
      .content{padding:20px}
      .header{padding:20px}
      .row{flex-direction:column}
      .label{margin-bottom:4px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
      <tr>
        <td align="center">
          <table class="container" cellspacing="0" cellpadding="0" border="0" width="600">
            <tr>
              <td class="header">
                <h1>DealGuard</h1>
                <p>Secure Transaction Platform</p>
              </td>
            </tr>
            <tr>
              <td class="content">
                <p class="greeting">Hello {{partyName}},</p>

                <div class="badge">
                  <div class="icon">âœ“</div>
                  <h2>Milestone Agreed</h2>
                  <p>All parties accepted</p>
                </div>

                <div class="celebration">
                  <div class="emoji">ðŸŽ‰</div>
                  <h3>Consensus Reached!</h3>
                  <p>All parties have agreed to <strong>Milestone {{milestoneOrder}}: {{milestoneTitle}}</strong></p>
                </div>

                <p class="msg">Great news! All parties have accepted the terms for this milestone in deal <strong>{{dealNumber}}</strong>. This milestone is now locked and confirmed.</p>

                <div class="details">
                  <h3>Agreed Milestone</h3>
                  <div class="row">
                    <div class="label">Deal Number</div>
                    <div class="value"><strong>{{dealNumber}}</strong></div>
                  </div>
                  <div class="row">
                    <div class="label">Deal Title</div>
                    <div class="value"><strong>{{dealTitle}}</strong></div>
                  </div>
                  <div class="row">
                    <div class="label">Milestone</div>
                    <div class="value">Milestone {{milestoneOrder}}: {{milestoneTitle}}</div>
                  </div>
                  <div class="row">
                    <div class="label">Amount</div>
                    <div class="value"><strong>{{currency}} {{amount}}</strong></div>
                  </div>
                  <div class="row">
                    <div class="label">Status</div>
                    <div class="value"><span class="checkmark">âœ“ APPROVED</span></div>
                  </div>
                </div>

                {{#if allMilestonesApproved}}
                <div class="celebration" style="background:linear-gradient(135deg,#fef3c7 0%,#fde68a 100%);border-color:#f59e0b">
                  <div class="emoji">ðŸŽŠ</div>
                  <h3 style="color:#92400e">All Milestones Approved!</h3>
                  <p style="color:#78350f">This was the final milestone. Your deal is now fully negotiated and will be activated shortly.</p>
                </div>
                {{else}}
                <div class="progress-box">
                  <h3>ðŸ“Š Deal Progress</h3>
                  <p>Remaining milestones to negotiate:</p>
                  <div class="count">{{remainingCount}}</div>
                  <p>Once all milestones are agreed upon, your deal will be activated.</p>
                </div>
                {{/if}}

                <div class="cta">
                  <a href="{{dealLink}}" class="btn">View Deal Dashboard</a>
                </div>

                <p class="msg" style="font-size:13px;color:#6b7280;margin-top:24px">
                  Questions? Email <a href="mailto:support@dealguard.org" style="color:#667eea">support@dealguard.org</a>
                </p>
              </td>
            </tr>
            <tr>
              <td class="footer">
                <p class="name">DealGuard</p>
                <p>Secure Transaction Platform</p>
                <p class="legal">
                  &copy; 2026 DealGuard. All rights reserved.
                </p>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </div>
</body>
</html>
